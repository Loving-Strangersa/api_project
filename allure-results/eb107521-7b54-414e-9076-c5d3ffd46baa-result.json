{"name": "test_play[case0]", "status": "broken", "statusDetails": {"message": "TypeError: a bytes-like object is required, not 'int'", "trace": "self = <test_cases.test_paly.Test_paly object at 0x00000268DACF3FA0>\ncase = {'api_url': '/playurl/v3/play/playurl', 'check_jsonpath_contId': '$.body.content.contId', 'check_jsonpath_contName': '$.body.content.contName', 'check_re': None, ...}\n\n    @pytest.mark.parametrize(\"case\",cases)\n    def test_play(self, case):\n        logger.info(\"用例开始执行,用例{}:{}\".format(case[\"id\"], case[\"title\"]))\n    \n        # 数据替换,替换Excel中request_data中contId 正则表达式 (?<=contId=).*?(?=&)\n        # case = replace_mark_with_data(cases,\"#contId#\",\"661543514\")\n    \n        # 发起请求\n>       response = send_request(method=case[\"method\"], url=case[\"api_url\"], data=case[\"request_data\"])\n\ntest_cases\\test_paly.py:54: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\ncommon\\handle_request.py:87: in send_request\n    allure.attach(int(response.status_code), \"反回状态码\", allure.attachment_type.TEXT)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\allure_commons\\_allure.py:179: in __call__\n    plugin_manager.hook.attach_data(body=body, name=name, attachment_type=attachment_type, extension=extension)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\pluggy\\hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\pluggy\\manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\pluggy\\manager.py:84: in <lambda>\n    self._inner_hookexec = lambda hook, methods, kwargs: hook.multicall(\nC:\\.virtualenv\\project_request\\lib\\site-packages\\allure_pytest\\listener.py:222: in attach_data\n    self.allure_logger.attach_data(uuid4(), body, name=name, attachment_type=attachment_type, extension=extension)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\allure_commons\\reporter.py:119: in attach_data\n    plugin_manager.hook.report_attached_data(body=body, file_name=file_name)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\pluggy\\hooks.py:286: in __call__\n    return self._hookexec(self, self.get_hookimpls(), kwargs)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\pluggy\\manager.py:93: in _hookexec\n    return self._inner_hookexec(hook, methods, kwargs)\nC:\\.virtualenv\\project_request\\lib\\site-packages\\pluggy\\manager.py:84: in <lambda>\n    self._inner_hookexec = lambda hook, methods, kwargs: hook.multicall(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <allure_commons.logger.AllureFileLogger object at 0x00000268D9A42FA0>\nbody = 200, file_name = 'de2b5ce9-5ba2-48b2-9a9b-4368056579c7-attachment.txt'\n\n    @hookimpl\n    def report_attached_data(self, body, file_name):\n        destination = os.path.join(self._report_dir, file_name)\n        with open(destination, 'wb') as attached_file:\n            if isinstance(body, text_type):\n                attached_file.write(body.encode('utf-8'))\n            else:\n>               attached_file.write(body)\nE               TypeError: a bytes-like object is required, not 'int'\n\nC:\\.virtualenv\\project_request\\lib\\site-packages\\allure_commons\\logger.py:62: TypeError"}, "attachments": [{"name": "请求方法", "source": "8b5a2b29-51f7-47b0-b50a-74cdd23a3e52-attachment.txt", "type": "text/plain"}, {"name": "请求路径", "source": "007edc67-2625-40ac-a7b3-631bea8b2385-attachment.txt", "type": "text/plain"}, {"name": "请求参数", "source": "0a5a6c4b-6b88-41b3-819d-f81f04c42558-attachment.txt", "type": "text/plain"}, {"name": "反回状态码", "source": "de2b5ce9-5ba2-48b2-9a9b-4368056579c7-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "case", "value": "{'id': 1, 'title': '请求正常播放节目', 'method': 'get', 'api_url': '/playurl/v3/play/playurl', 'request_data': 'contId=661543514&ott=true&rateType=&ott=false', 'expected': '{\\n    \"code\": \"200\",\\n    \"rid\": \"SUCCESS\",\\n    \"playCode\": \"100000\",\\n    \"respId\": \"3e1aa4cc336695e70ac4eb74907b2d35_eUmJPxTPjoilDrHQ0wRnMw==\",\\n    \"info\": null,\\n    \"message\": \"SUCCESS\",\\n    \"httpmessage\": null,\\n    \"timeStamp\": 1614146405554,\\n    \"body\": {\\n        \"content\": {\\n            \"contId\": \"661543514\",\\n            \"contName\": \"哥斯拉2：怪兽之王\",\\n            \"bcName\": \"咪咕视讯央视易橙联合运营\",\\n            \"prdPackageId\": \"1004641\",\\n            \"needAuth\": false,\\n            \"duration\": \"7897\",\\n            \"titleValue\": 0,\\n            \"endValue\": 0,\\n            \"productIds\": \"2028600496\",\\n            \"contentLevel\": \"\",\\n            \"vid\": null,\\n            \"cpName\": \"\",\\n            \"playerType\": null,\\n            \"assetId\": \"5102217994\",\\n            \"preRecord\": null,\\n            \"cutVideo\": \"1\",\\n            \"thumbViewer\": null,\\n            \"thumbViewerPath\": null,\\n            \"thumbViewerName\": null,\\n            \"hasAudio\": true,\\n            \"tip\": {\\n                \"code\": \"USE_TICKET\",\\n                \"msg\": \"用券\"\\n            },\\n            \"mmsId\": \"5500742150\",\\n            \"vrImageDistortion\": \"\",\\n            \"vrImageDepth\": \"\",\\n            \"serialContentId\": null,\\n            \"albumIDS\": \"\",\\n            \"progSnapshot\": \"\",\\n            \"miguPublish\": \"1\",\\n            \"chipMatch\": null,\\n            \"copyright\": {\\n                \"ncpid\": \"800033\",\\n                \"ncpcode\": null,\\n                \"copyRightObjectID\": \"100089684\",\\n                \"authorizationWay\": \"1\"\\n            },\\n            \"ottEnable\": \"1\",\\n            \"contentMediaType\": {\\n                \"isDrmContent\": false,\\n                \"isPekMultView\": false,\\n                \"isH265\": true,\\n                \"isMultiViewContent\": false,\\n                \"isDolbyContent\": true,\\n                \"isAdvance\": false,\\n                \"is120FPS\": false,\\n                \"is3D\": false,\\n                \"isVRContent\": false,\\n                \"ishx\": false,\\n                \"isSpecialBlest\": false\\n            },\\n            \"vrContentType\": null,\\n            \"dimension\": null,\\n            \"formatOf3D\": null,\\n            \"viewDegree\": null,\\n            \"copyRightObjectID\": \"100089684\",\\n            \"drm\": false\\n        },\\n        \"playBill\": null,\\n        \"auth\": {\\n            \"logined\": false,\\n            \"authResult\": \"FAIL\",\\n            \"resultDesc\": null,\\n            \"member\": null,\\n            \"benefites\": null,\\n            \"authPassDefinitionMap\": null\\n        },\\n        \"urlInfo\": {\\n            \"urlType\": \"trial\",\\n            \"url\": \"http://gslbmgspvod.miguvideo.com/depository_yqv/asset/zhengshi/5102/217/994/5102217994/media/5102217994_5009199724_570.mg001.mp4.m3u8?msisdn=202102241400050f1f7850ca764fd8ae371ff609c10773&mdspid=&spid=800033&netType=0&sid=5500742150&pid=2028600496&timestamp=20210224140005&Channel_ID=0116_25000000-99000-100300010010001&ProgramID=661543514&ParentNodeID=-99&preview=1&playseek=000000-000600&assertID=5500742150&client_ip=221.181.101.37&SecurityKey=20210224140005&mvid=5102217994&mcid=1000&mpid=130000119466&playurlVersion=SJ-A1-0.0.3&userid=&jmhm=&videocodec=h265&encrypt=e08325256f7e7ecfbdd1115c4375c4e9\",\\n            \"mediaType\": \"10\",\\n            \"usageCode\": \"570\",\\n            \"codeRate\": \"800\",\\n            \"mediaSize\": 8868182592,\\n            \"rateDesc\": \"投电视专享（VIP限免）\",\\n            \"contId\": null,\\n            \"rateType\": \"8\",\\n            \"needClothHat\": true,\\n            \"resultCode\": \"200\",\\n            \"videoCoding\": \"h265\",\\n            \"hdCodeType\": \"2\",\\n            \"iconImgUrl\": \"http://img.cmvideo.cn:8080/publish/noms/2019/10/12/1O1A9R9ED89KP.png\",\\n            \"trySeeDuration\": \"360\",\\n            \"definitionRightSource\": null,\\n            \"authRightSource\": null,\\n            \"userDolbyPlay\": null,\\n            \"streamCode\": null,\\n            \"sdkPlay\": null,\\n            \"outPutFormat\": \"ts\",\\n            \"mediaHeight\": \"2160\",\\n            \"mediaWidth\": \"3840\",\\n            \"hdEquityInfo\": null\\n        },\\n        \"urlInfos\": [\\n            {\\n                \"urlType\": \"trial\",\\n                \"url\": \"http://gslbmgspvod.miguvideo.com/depository_yqv/asset/zhengshi/5102/217/994/5102217994/media/5102217994_5009199724_570.mg001.mp4.m3u8?msisdn=202102241400050f1f7850ca764fd8ae371ff609c10773&mdspid=&spid=800033&netType=0&sid=5500742150&pid=2028600496&timestamp=20210224140005&Channel_ID=0116_25000000-99000-100300010010001&ProgramID=661543514&ParentNodeID=-99&preview=1&playseek=000000-000600&assertID=5500742150&client_ip=221.181.101.37&SecurityKey=20210224140005&mvid=5102217994&mcid=1000&mpid=130000119466&playurlVersion=SJ-A1-0.0.3&userid=&jmhm=&videocodec=h265&encrypt=e08325256f7e7ecfbdd1115c4375c4e9\",\\n                \"mediaType\": \"10\",\\n                \"usageCode\": \"570\",\\n                \"codeRate\": \"800\",\\n                \"mediaSize\": 8868182592,\\n                \"rateDesc\": \"投电视专享（VIP限免）\",\\n                \"contId\": null,\\n                \"rateType\": \"8\",\\n                \"needClothHat\": true,\\n                \"resultCode\": \"200\",\\n                \"videoCoding\": \"h265\",\\n                \"hdCodeType\": \"2\",\\n                \"iconImgUrl\": \"http://img.cmvideo.cn:8080/publish/noms/2019/10/12/1O1A9R9ED89KP.png\",\\n                \"trySeeDuration\": \"360\",\\n                \"definitionRightSource\": null,\\n                \"authRightSource\": null,\\n                \"userDolbyPlay\": null,\\n                \"streamCode\": null,\\n                \"sdkPlay\": null,\\n                \"outPutFormat\": \"ts\",\\n                \"mediaHeight\": \"2160\",\\n                \"mediaWidth\": \"3840\",\\n                \"hdEquityInfo\": null\\n            }\\n        ],\\n        \"mediaFiles\": [\\n            {\\n                \"usageCode\": \"455\",\\n                \"mediaType\": \"10\",\\n                \"codeRate\": \"80\",\\n                \"rateDesc\": \"高清 540P\",\\n                \"needAuth\": false,\\n                \"fileSize\": \"988947697\",\\n                \"rateType\": \"2\",\\n                \"videoCoding\": \"h264\",\\n                \"hdCodeType\": null,\\n                \"iconImgUrl\": null,\\n                \"userDolbyPlay\": null,\\n                \"rateTypeDesc\": null,\\n                \"currentTerminalCanSwitch\": \"1\",\\n                \"ottEnable\": \"1\"\\n            },\\n            {\\n                \"usageCode\": \"91\",\\n                \"mediaType\": \"10\",\\n                \"codeRate\": \"160\",\\n                \"rateDesc\": \"超清 720P\",\\n                \"needAuth\": false,\\n                \"fileSize\": \"1971195987\",\\n                \"rateType\": \"3\",\\n                \"videoCoding\": \"h264\",\\n                \"hdCodeType\": null,\\n                \"iconImgUrl\": null,\\n                \"userDolbyPlay\": null,\\n                \"rateTypeDesc\": null,\\n                \"currentTerminalCanSwitch\": \"1\",\\n                \"ottEnable\": \"1\"\\n            },\\n            {\\n                \"usageCode\": \"92\",\\n                \"mediaType\": \"10\",\\n                \"codeRate\": \"210\",\\n                \"rateDesc\": \"蓝光 1080P\",\\n                \"needAuth\": true,\\n                \"fileSize\": \"3930526042\",\\n                \"rateType\": \"4\",\\n                \"videoCoding\": \"h264\",\\n                \"hdCodeType\": null,\\n                \"iconImgUrl\": null,\\n                \"userDolbyPlay\": null,\\n                \"rateTypeDesc\": null,\\n                \"currentTerminalCanSwitch\": \"1\",\\n                \"ottEnable\": \"1\"\\n            },\\n            {\\n                \"usageCode\": \"570\",\\n                \"mediaType\": \"10\",\\n                \"codeRate\": \"800\",\\n                \"rateDesc\": \"投电视专享（VIP限免）\",\\n                \"needAuth\": true,\\n                \"fileSize\": \"8868182592\",\\n                \"rateType\": \"8\",\\n                \"videoCoding\": \"h265\",\\n                \"hdCodeType\": \"2\",\\n                \"iconImgUrl\": \"http://img.cmvideo.cn:8080/publish/noms/2019/10/12/1O1A9R9ED89KP.png\",\\n                \"userDolbyPlay\": null,\\n                \"rateTypeDesc\": null,\\n                \"currentTerminalCanSwitch\": \"1\",\\n                \"ottEnable\": \"1\"\\n            }\\n        ],\\n        \"degradeRateInfo\": null,\\n        \"priceInfo\": null,\\n        \"clientAction\": {},\\n        \"terminal\": {\\n            \"suitAvs2\": \"false\",\\n            \"suitAvs2Desc\": \"本节目采用全新avs2技术标准，部分机型若无法播放，请手动选择其他视频观看\",\\n            \"suitMultiView\": \"false\",\\n            \"suitMultiViewDesc\": \"本节目采用全新多视角技术，部分机型可能无法流畅播放，您可以观看其他精彩内容，敬请谅解\"\\n        },\\n        \"advertInfo\": {\\n            \"isAdvert\": \"3\",\\n            \"toast\": null,\\n            \"playLengths\": null,\\n            \"reason\": null,\\n            \"source\": null\\n        },\\n        \"startRate\": null,\\n        \"cpinfo\": {\\n            \"shortName\": \"-\"\\n        },\\n        \"dolbyUrlInfo\": null,\\n        \"gslbCdn\": null\\n    }\\n}', 'check_sql': None, 'check_jsonpath_contId': '$.body.content.contId', 'check_jsonpath_contName': '$.body.content.contName', 'check_re': None}"}], "start": 1623926718399, "stop": 1623926718463, "uuid": "d5e23ca2-545c-4f3a-82e6-0e17d624b0e4", "historyId": "b6e9989b9d92c973d5c459eff82bdbfb", "testCaseId": "ee410dde69c0cbc8d0749e68a9971b87", "fullName": "test_cases.test_paly.Test_paly#test_play", "labels": [{"name": "parentSuite", "value": "test_cases"}, {"name": "suite", "value": "test_paly"}, {"name": "subSuite", "value": "Test_paly"}, {"name": "host", "value": "DESKTOP-V4MS4DA"}, {"name": "thread", "value": "21984-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_cases.test_paly"}]}